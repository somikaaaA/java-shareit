CREATE TABLE IF NOT EXISTS users (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  name VARCHAR(255) NOT NULL,
  email VARCHAR(512) NOT NULL,
  CONSTRAINT pk_user PRIMARY KEY (id),
  CONSTRAINT UQ_USER_EMAIL UNIQUE (email)
);

CREATE TABLE IF NOT EXISTS requests (
  id INTEGER GENERATED ALWAYS AS IDENTITY PRIMARY KEY NOT NULL,
  description TEXT NOT NULL,
  requestor INTEGER REFERENCES users(id) ON DELETE CASCADE,
  created TIMESTAMP WITHOUT TIME ZONE DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS items (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  name VARCHAR(255) NOT NULL,
  description TEXT NOT NULL,
  available BOOLEAN DEFAULT TRUE NOT NULL,
  owner INTEGER REFERENCES users(id) ON DELETE CASCADE,
  request INTEGER REFERENCES requests(id) ON DELETE SET NULL
);